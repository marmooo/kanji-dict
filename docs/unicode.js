function loadConfig(){localStorage.getItem("darkMode")==1&&document.documentElement.setAttribute("data-bs-theme","dark")}function toggleDarkMode(){localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),document.documentElement.setAttribute("data-bs-theme","light")):(localStorage.setItem("darkMode",1),document.documentElement.setAttribute("data-bs-theme","dark"))}function checkCharacters(e){return new Promise(t=>{const n=e=>{worker.removeEventListener("message",n),t(e.data)};worker.addEventListener("message",n),worker.postMessage({chars:e})})}function isElementInViewport(e){const{top:t,bottom:n}=e.getBoundingClientRect();return 0<=n&&t<=globalThis.innerHeight}async function checkSupportInViewport(){if(running)return;running=!0;const e=codeTrs.filter(e=>isElementInViewport(e));for(const n of e){const t=n.children,s=t[0].textContent,o=Number(`0x${s}`),i=Array(16).fill().map((e,t)=>o+t),a=i.map(e=>String.fromCodePoint(e)),r=await checkCharacters(a);await Promise.all(r.map((e,n)=>{const s=t[n+1];!s.classList.contains("bg-warning-subtle")&&!e.supported&&s.classList.add("bg-warning-subtle")}))}running=!1}loadConfig();let scrollTimeout,running=!1;const worker=new Worker("/kanji-dict/unicode-worker.js",{type:"module"}),codeTrs=[...document.querySelectorAll("#table tr")].slice(1);checkSupportInViewport(),document.getElementById("toggleDarkMode").onclick=toggleDarkMode,globalThis.addEventListener("scroll",()=>{clearTimeout(scrollTimeout),scrollTimeout=setTimeout(checkSupportInViewport,100)})