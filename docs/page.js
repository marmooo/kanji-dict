function loadConfig(){localStorage.getItem("darkMode")==1&&document.documentElement.setAttribute("data-bs-theme","dark")}function toggleDarkMode(){const a=document.getElementById("kanji").contentDocument.documentElement;localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),document.documentElement.setAttribute("data-bs-theme","light"),a.style.background="#fff",a.firstElementChild.style.stroke="#000"):(localStorage.setItem("darkMode",1),document.documentElement.setAttribute("data-bs-theme","dark"),a.style.background="#212529",a.firstElementChild.style.stroke="#fff")}function prev(){animator.stop().finish(),currPos-=1,currPos<1&&(currPos=1);let a=1;while(!0){const b=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+a);if(b)a<currPos?b.setAttribute("stroke","inherit"):a==currPos?b.setAttribute("stroke","red"):b.setAttribute("stroke","none");else break;a+=1}}function stop(){animator.stop().finish(),currPos=0;let a=1;while(!0){const b=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+a);if(b)b.setAttribute("stroke","inherit");else break;a+=1}document.getElementById("stop").classList.add("d-none"),document.getElementById("play").classList.remove("d-none")}function play(){animator.reset().play();let a=1;while(!0){const b=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+a);if(b)b.setAttribute("stroke","inherit");else break;a+=1}document.getElementById("stop").classList.remove("d-none"),document.getElementById("play").classList.add("d-none")}function next(){animator.stop().finish(),currPos<kakusu&&(currPos+=1);let a=1;while(!0){const b=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+a);if(b)a<currPos?b.setAttribute("stroke","inherit"):a==currPos?b.setAttribute("stroke","red"):b.setAttribute("stroke","none");else break;a+=1}}function getKakusu(){let a=1;while(!0){const b=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+a);if(b)a+=1;else break}return a-1}function addHitsujun(){const a=document.getElementById("hitsujun");for(let c=1;c<=kakusu;c++){const b=kanjiSvg.cloneNode(!0);b.setAttribute("width",64),b.setAttribute("height",64),b.removeAttribute("id");for(let a=c+1;a<=kakusu;a++){const e="kvg:"+kanjiId+"-s"+a,d=b.querySelector(`[id="${e}"]`);d.setAttribute("stroke","lightgray"),d.removeAttribute("id")}a.appendChild(b)}}function addAnimation(){animator=new Vivus("kanji",{type:"oneByOne",duration:kakusu*50},()=>{setTimeout(addAnimation,2e3)})}function isLoaded(c){const a=c.contentDocument;if(!a)return!1;const b=a.querySelector("svg");return!!b&&(!(b.getCurrentTime()<0))}function initPage(a){if(kanjiSvg=a.contentDocument.documentElement,kakusu=getKakusu(),addHitsujun(),addAnimation(),localStorage.getItem("darkMode")==1){const a=document.getElementById("kanji").contentDocument.documentElement;a.style.background="#212529",a.firstElementChild.style.stroke="#fff"}}function init(a){isLoaded(a)?initPage(a):a.onload=()=>{initPage(a)}}loadConfig();const object=document.getElementById("kanji"),kanjiId=object.data.split("/").at(-1).split(".")[0];let animator,kanjiSvg,kakusu,currPos=1;init(object),document.getElementById("toggleDarkMode").onclick=toggleDarkMode,document.getElementById("next").onclick=next,document.getElementById("play").onclick=play,document.getElementById("stop").onclick=stop,document.getElementById("prev").onclick=prev