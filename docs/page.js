function loadConfig(){localStorage.getItem("darkMode")==1&&document.documentElement.setAttribute("data-bs-theme","dark")}function toggleDarkMode(){const e=document.getElementById("kanji").contentDocument.documentElement;localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),document.documentElement.setAttribute("data-bs-theme","light"),e.style.background="#fff",e.firstElementChild.style.stroke="#000"):(localStorage.setItem("darkMode",1),document.documentElement.setAttribute("data-bs-theme","dark"),e.style.background="#212529",e.firstElementChild.style.stroke="#fff")}function prev(){animator.stop().finish(),currPos-=1,currPos<1&&(currPos=1);let e=1;for(;!0;){const t=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+e);if(t)e<currPos?t.setAttribute("stroke","inherit"):e==currPos?t.setAttribute("stroke","red"):t.setAttribute("stroke","none");else break;e+=1}}function stop(){animator.stop().finish(),currPos=0;let e=1;for(;!0;){const t=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+e);if(t)t.setAttribute("stroke","inherit");else break;e+=1}document.getElementById("stop").classList.add("d-none"),document.getElementById("play").classList.remove("d-none")}function play(){animator.reset().play();let e=1;for(;!0;){const t=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+e);if(t)t.setAttribute("stroke","inherit");else break;e+=1}document.getElementById("stop").classList.remove("d-none"),document.getElementById("play").classList.add("d-none")}function next(){animator.stop().finish(),currPos<kakusu&&(currPos+=1);let e=1;for(;!0;){const t=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+e);if(t)e<currPos?t.setAttribute("stroke","inherit"):e==currPos?t.setAttribute("stroke","red"):t.setAttribute("stroke","none");else break;e+=1}}function getKakusu(){let e=1;for(;!0;){const t=kanjiSvg.getElementById("kvg:"+kanjiId+"-s"+e);if(t)e+=1;else break}return e-1}function addHitsujun(){const e=document.getElementById("hitsujun");for(let n=1;n<=kakusu;n++){const t=kanjiSvg.cloneNode(!0);t.setAttribute("width",64),t.setAttribute("height",64),t.removeAttribute("id");for(let e=n+1;e<=kakusu;e++){const o="kvg:"+kanjiId+"-s"+e,s=t.querySelector(`[id="${o}"]`);s.setAttribute("stroke","lightgray"),s.removeAttribute("id")}e.appendChild(t)}}function addAnimation(){animator=new Vivus("kanji",{type:"oneByOne",duration:kakusu*50},()=>{setTimeout(addAnimation,2e3)})}function isLoaded(e){const t=e.contentDocument;if(!t)return!1;const n=t.querySelector("svg");return!!n&&!(n.getCurrentTime()<0)}function initPage(e){if(kanjiSvg=e.contentDocument.documentElement,kakusu=getKakusu(),addHitsujun(),addAnimation(),localStorage.getItem("darkMode")==1){const e=document.getElementById("kanji").contentDocument.documentElement;e.style.background="#212529",e.firstElementChild.style.stroke="#fff"}}function init(e){isLoaded(e)?initPage(e):e.onload=()=>{initPage(e)}}loadConfig();const object=document.getElementById("kanji"),kanjiId=object.data.split("/").at(-1).split(".")[0];let animator,kanjiSvg,kakusu,currPos=1;init(object),document.getElementById("toggleDarkMode").onclick=toggleDarkMode,document.getElementById("next").onclick=next,document.getElementById("play").onclick=play,document.getElementById("stop").onclick=stop,document.getElementById("prev").onclick=prev